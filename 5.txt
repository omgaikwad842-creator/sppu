import pandas as pd
from sklearn.preprocessing import LabelEncoder, StandardScaler
from sklearn.cluster import KMeans, AgglomerativeClustering
import matplotlib.pyplot as plt

df = pd.read_csv("Mall_Customers.csv")

le = LabelEncoder()
df['Gender'] = le.fit_transform(df['Gender'])

X = df[['Spending Score (1-100)']]
scaler = StandardScaler()
X_scaled = scaler.fit_transform(X)

kmeans = KMeans(n_clusters=5, random_state=0)
df['KMeans_Cluster'] = kmeans.fit_predict(X_scaled)

agg = AgglomerativeClustering(n_clusters=5, linkage='ward')
df['Agglo_Cluster'] = agg.fit_predict(X_scaled)

plt.scatter(df.index, X_scaled, c=df['KMeans_Cluster'])
plt.title("KMeans Clusters")
plt.show()

plt.scatter(df.index, X_scaled, c=df['Agglo_Cluster'])
plt.title("Agglomerative Clusters")
plt.show()

df.to_csv("mall_clusters.csv", index=False)
print("Clusters saved to mall_clusters.csv")
